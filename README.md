# 电商管理系统

基于Next.js 14、TypeScript、Tailwind CSS和Supabase构建的电商管理系统。

## 功能特点

- 分类管理：创建、编辑和删除商品分类
- 商品管理：
  - 创建、编辑和删除商品
  - 设置商品名称、价格、描述和分类
  - **支持多图片上传**：每个商品可上传一张主图和最多5张额外图片
  - 图片预览功能

## 技术栈

- **前端**：
  - Next.js 14（App Router）
  - TypeScript
  - Tailwind CSS
  - React Hooks

- **后端**：
  - Supabase
    - 数据库：PostgreSQL
    - 身份验证
    - 存储：商品图片存储

## 图片上传功能说明

### 新增功能

1. **多图片上传支持**：
   - 一张主图片：显示为商品的主要图片
   - 最多5张额外图片：在商品详情中作为缩略图展示

2. **图片上传进度条**：
   - 显示图片上传的实时进度
   - 上传状态提示（上传中、上传成功、上传失败）

3. **Supabase存储检查**：
   - 自动验证Supabase存储配置
   - 自动创建所需的存储桶
   - 提供存储状态反馈

### 使用方法

1. **上传主图片**：
   - 点击"选择主图片"按钮
   - 选择一张不超过2MB的图片文件
   - 上传成功后会显示预览

2. **上传额外图片**：
   - 点击"选择额外图片"按钮
   - 可以选择多张图片（总数不超过5张）
   - 每张图片会显示上传状态（上传中/已上传/上传失败）
   - 可以单独删除或批量删除额外图片

3. **图片存储**：
   - 所有图片将存储在Supabase Storage的images桶中
   - 图片路径格式为`products/[唯一ID].[扩展名]`
   - 图片可以公开访问

## 环境设置

创建一个`.env`文件，并添加以下变量（可参考`env.template`）：

```
NEXT_PUBLIC_SUPABASE_URL=你的supabase项目URL
NEXT_PUBLIC_SUPABASE_ANON_KEY=你的supabase匿名密钥
```

## 开发

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

## 部署

该项目可以部署到Vercel或其他支持Next.js的平台。

```bash
# 构建生产版本
npm run build

# 启动生产服务器
npm start
```

## 本地运行指南

1. **克隆仓库**

```bash
git clone https://github.com/yitntg/admin5.git
cd admin5
```

2. **安装依赖**

```bash
npm install
```

3. **配置环境变量**

复制`env.template`文件并重命名为`.env.local`，填入您的Supabase项目信息：

```
NEXT_PUBLIC_SUPABASE_URL=您的Supabase项目URL
NEXT_PUBLIC_SUPABASE_ANON_KEY=您的Supabase匿名密钥
```

4. **启动开发服务器**

```bash
npm run dev
```

5. **访问应用**

打开浏览器访问 [http://localhost:3000](http://localhost:3000)

## 数据库设置

在Supabase中创建以下表：

### 分类表 (categories)

```sql
create table categories (
  id bigint generated by default as identity primary key,
  name text not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  updated_at timestamp with time zone default timezone('utc'::text, now()) not null
);
```

### 商品表 (products)

```sql
create table products (
  id bigint generated by default as identity primary key,
  name text not null,
  description text not null,
  price decimal(10,2) not null,
  category_id bigint references categories(id) not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  updated_at timestamp with time zone default timezone('utc'::text, now()) not null
);
```

## 生产环境部署

项目可以部署在Vercel上，并将Supabase环境变量配置在Vercel的项目设置中。

## 后续开发计划

- 编辑和删除功能
- 图片上传
- 库存管理
- 订单管理
- 用户认证
- 权限控制  
